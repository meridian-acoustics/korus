

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KetosAM Documentation &mdash; ketosam 0.0.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="_static/_static/custom.css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
      <link rel="stylesheet" href="_static/style.css" type="text/css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=1fd71caa"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Briefly about KetosAM" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

    
    <a href="#" class="icon icon-home"> ketosam
    

    
    </a>

    <div class="ooa-sidebar-text">Processing and automated analysis of underwater acoustics data</div>

    
    
    
    
        <div class="version">
        0.0
        </div>
    
    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Briefly about KetosAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#getting-started">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#code-examples">Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#cautionary-note">Cautionary Note</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#annotation-taxonomies">Annotation Taxonomies</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#relation-to-ketos">Relation to Ketos</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#developers">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema/index.html">Database Schema</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules/index.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions/index.html">Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">ketosam</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">KetosAM Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ketosam-documentation">
<h1>KetosAM Documentation<a class="headerlink" href="#ketosam-documentation" title="Link to this heading"></a></h1>
<p>Welcome to KetosAM, a Python package for managing acoustic annotations.</p>
<section id="briefly-about-ketosam">
<h2>Briefly about KetosAM<a class="headerlink" href="#briefly-about-ketosam" title="Link to this heading"></a></h2>
<p>KetosAM was designed with machine-learning applications in mind. Specifically,
to help build training and test sets for advancing sound detection and
classification models in underwater acoustics.</p>
<p>KetosAM stores acoustic annotations and metadata in an SQLite database.
The data are organized in several cross-referenced tables, the main
tables being</p>
<blockquote>
<div><ul class="simple">
<li><p>deployment: metadata pertaining hydrophone deployments</p></li>
<li><p>file: metadata pertaining to audio files</p></li>
<li><p>storage: data storage locations for audio files</p></li>
<li><p>taxonomy: taxonomies used for annotating sound sources and sound types</p></li>
<li><p>job: metadata pertaining to annotation jobs</p></li>
<li><p>annotation: acoustic annotations</p></li>
<li><p>label: standardized annotation labels employed by the taxonomies</p></li>
<li><p>tag: non-standardized tags used for annotating sound events</p></li>
</ul>
</div></blockquote>
<p>The KetosAM Python API includes functions to facilitate common operations
on the database such as adding data and performing certain searches.
However, it is also possible to interact directly with the database
using standard SQLite syntax.</p>
<p>The Python API also includes functions for creating and managing annotation
taxonomies programmatically.</p>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<p>There are two ways to use KetosAM:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Write your own Python scripts using the KetosAM Python API</p></li>
<li><p>Use the command-line tool <cite>ktam-submit</cite> included in KetosAM</p></li>
</ol>
</div></blockquote>
</section>
<section id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h2>
<p>To familiarize yourself with the KetosAM Python API we encourage you to
explore the Jupyter notebooks <a class="reference internal" href="tutorials/index.html#tutorials-page"><span class="std std-ref">Tutorials</span></a>.</p>
</section>
<section id="code-examples">
<h2>Code Examples<a class="headerlink" href="#code-examples" title="Link to this heading"></a></h2>
<p>Import modules and connect to the database,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ketosam.db</span> <span class="k">as</span> <span class="nn">kdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;db.sqlite&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>View the taxonomy used by the acoustic analyst for labelling sound sources,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tax</span> <span class="o">=</span> <span class="n">kdb</span><span class="o">.</span><span class="n">get_taxonomy</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tax</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">append_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Unknown</span>
<span class="go">├── Anthro [Anthropogenic]</span>
<span class="go">│   └── Boat</span>
<span class="go">│       ├── Engine</span>
<span class="go">│       └── Prop [Propeller]</span>
<span class="go">└── Bio [Biological]</span>
<span class="go">    └── Whale</span>
<span class="go">        ├── HW [Humpback whale]</span>
<span class="go">        └── NARW [North Atlantic right whale]</span>
</pre></div>
</div>
<p>and the taxonomy used for labelling NARW vocalisations,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tax</span><span class="o">.</span><span class="n">sound_types</span><span class="p">(</span><span class="s2">&quot;NARW&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">append_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Unknown</span>
<span class="go">├── GS [Gun shot]</span>
<span class="go">└── TC [Tonal call]</span>
<span class="go">    └── Upcall</span>
</pre></div>
</div>
<p>Search the database for NARW upcalls,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">kdb</span><span class="o">.</span><span class="n">filter_annotation</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;NARW&quot;</span><span class="p">,</span><span class="s2">&quot;Upcall&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="go">[1, 4, 12]</span>
</pre></div>
</div>
<p>Retrieve the annotations in <a class="reference external" href="https://docs.meridian.cs.dal.ca/ketos/introduction.html">Ketos</a>-friendly format,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">annot_tbl</span><span class="p">,</span> <span class="n">label_dict</span> <span class="o">=</span> <span class="n">kdb</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">ketos</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">label_dict</span><span class="p">)</span>
<span class="go">{0: &#39;NARW;Upcall&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">annot_tbl</span><span class="p">)</span>
<span class="go">                           filename  dir_path     start  duration  freq_min  freq_max  label comments</span>
<span class="go">0   audio_20130623T080000.116Z.flac  20130623  1127.340       3.0         0       500      0     None</span>
<span class="go">1   audio_20130623T080000.116Z.flac  20130623  1152.026       3.0         0       500      0     None</span>
<span class="go">2   audio_20130623T080000.116Z.flac  20130623  1195.278       3.0         0       500      0     None</span>
</pre></div>
</div>
<p>Finally, close the connection to the database,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="cautionary-note">
<h2>Cautionary Note<a class="headerlink" href="#cautionary-note" title="Link to this heading"></a></h2>
<p>KetosAM is still in its infancy and under heavy development. We aim to have a first, stable
release out by the end of 2023, but until then users should be prepared for substantial and
non-backward compatible changes to the code base. If you have any feedback for us, we would
love to hear it. Please create an issue on the
<a class="reference external" href="https://git-dev.cs.dal.ca/meridian/ketosam">KetosAM GitLab repository</a>.</p>
</section>
<section id="annotation-taxonomies">
<h2>Annotation Taxonomies<a class="headerlink" href="#annotation-taxonomies" title="Link to this heading"></a></h2>
<p>KetosAM gives users the freedom to create their own annotation taxonomies,
with two structural constraints:</p>
<blockquote>
<div><ul class="simple">
<li><p>The taxonomy must exhibit a hierarchical, tree-like structure in which more specific
categories derive from more general ones. (For example, a killer whale is a particular
type of toothed whale, which in turn is a type of whale, which is a type of marine
mammal, etc.)</p></li>
<li><p>The taxonomy must address both sound <em>sources</em> and sound <em>types</em>, in the following sense:
When annotating acoustic data, it is customary to use not one, but two ‘tags’ to label
sounds: one tag to specify what made the sound, i.e, its <em>source</em> (e.g. a killer whale)
and another tag to specify what the sound sounds like, i.e., the <em>type</em> of sound
(e.g. a tonal call). KetosAM does not enforce a ‘universal’ taxonomy of sound
types shared by all sound sources. Instead, every sound sources is allowed to have its
own taxonomy of sound types.</p></li>
</ul>
</div></blockquote>
<p>Enforcing the use of annotation taxonomies is useful for two reasons: First, they provide
a standard vocabulary for labelling sounds, which ensures that labels are consistent
across annotation efforts (e.g. killer whales are consistently tagged as ‘KW’ rather
than a mixture of ‘killer whale’, ‘orca’, ‘KW’, etc.). Second, their hierarchical structure
provides a recipe for combining sets of annotations that employ different levels of
specificity (e.g. ‘killer whale’ and ‘toothed whale’).</p>
<p>KetosAM allows for taxonomies to evolve over time. That is, users can make changes to the
taxonomy (e.g. add a new sound source, or merge two sound types into a single category) and
save the modified taxonomy to the database alongside the existing ones.</p>
</section>
<section id="relation-to-ketos">
<h2>Relation to Ketos<a class="headerlink" href="#relation-to-ketos" title="Link to this heading"></a></h2>
<p>The name KetosAM was chosen to highlight the connection to
<a class="reference external" href="https://docs.meridian.cs.dal.ca/ketos/introduction.html">Ketos</a>,
a Python package for developing and training deep learning models
to solve detection and classification tasks in underwater acoustics.</p>
<p>While Ketos includes basic utilities for managing acoustic
annotations and metadata, we have found these utilities to be
insufficient for managing larger projects that combine datasets
from multiple sources and employ richer annotation taxonomies - hence
the need for KetosAM.</p>
<p>While KetosAM does integrate nicely with Ketos - for example, KetosAM
has functions for ingesting and exporting annotation tables in the
standard Ketos format - it can be used entirely independently of Ketos.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Link to this heading"></a></h2>
<p>KetosAM is licensed under the <a class="reference external" href="https://www.gnu.org/licenses/">GNU GPLv3 license</a>
and hence freely available for anyone to use and modify.</p>
</section>
<section id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Link to this heading"></a></h2>
<p>KetosAM was developed to meet the data management needs of the
<a class="reference external" href="https://orca.research.sfu.ca/">HALLO (Humans and Algorithms Listening and Looking for Orcas)</a>
project, and the design of KetosAM has been informed by numerous conversations
with members of the HALLO team.</p>
<p>The HALLO project has been generously supported by the Canadian Department of Fisheries
and Oceans through Grants and Contribution Agreements and the Canada Nature Fund for Aquatic
Species at Risk program. Furthermore, graduate students in the HALLO project have received
support through partnerships with NSERC, MITACS, SIMRES, JASCO, SMRU Consulting and the Vancouver
Port’s ECHO Program.</p>
</section>
<section id="developers">
<h2>Developers<a class="headerlink" href="#developers" title="Link to this heading"></a></h2>
<p>Oliver S. Kirsebom</p>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="introduction.html" class="btn btn-neutral float-right" title="Briefly about KetosAM" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
        &copy; Copyright 2023 HALLO

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>